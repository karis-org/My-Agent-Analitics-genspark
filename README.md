# My Agent Analytics

**AIã‚’æ´»ç”¨ã—ãŸä¸å‹•ç”£æŠ•è³‡åˆ†æãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ **

[![Cloudflare Pages](https://img.shields.io/badge/Cloudflare-Pages-orange)](https://pages.cloudflare.com/)
[![Hono](https://img.shields.io/badge/Framework-Hono-blue)](https://hono.dev/)
[![TypeScript](https://img.shields.io/badge/TypeScript-5.0-blue)](https://www.typescriptlang.org/)
[![License](https://img.shields.io/badge/License-MIT-green)](LICENSE)

## ğŸ¯ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

My Agent Analyticsã¯ã€ä¸å‹•ç”£ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¨æŠ•è³‡å®¶å‘ã‘ã®åŒ…æ‹¬çš„ãªãƒ‡ãƒ¼ã‚¿åˆ†æãƒ»ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆãƒ„ãƒ¼ãƒ«ã§ã™ã€‚ç‰©ä»¶ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã ã‘ã§ã€AIã¨æ”¿åºœçµ±è¨ˆãƒ‡ãƒ¼ã‚¿ï¼ˆe-Statï¼‰ã‚’æ´»ç”¨ã—ãŸè©³ç´°ãªå¸‚å ´åˆ†æãƒ¬ãƒãƒ¼ãƒˆã‚’è‡ªå‹•ç”Ÿæˆã—ã¾ã™ã€‚

### ğŸŒŸ ä¸»ãªç‰¹å¾´

- **ğŸ“Š è‡ªå‹•è¨ˆç®—**: NOIã€åˆ©å›ã‚Šã€DSCRã€LTVãªã©ã®æŠ•è³‡æŒ‡æ¨™ã‚’è‡ªå‹•ç®—å‡º
- **ğŸ“ˆ å®Ÿãƒ‡ãƒ¼ã‚¿åˆ†æ**: å›½åœŸäº¤é€šçœã®å®Ÿå–å¼•ä¾¡æ ¼ãƒ‡ãƒ¼ã‚¿ã§å¸‚å ´å‹•å‘ã‚’åˆ†æ
- **ğŸ¢ ä¾¡æ ¼æ¨å®š**: å‘¨è¾ºå–å¼•äº‹ä¾‹ã‹ã‚‰ç‰©ä»¶ä¾¡æ ¼ã‚’è‡ªå‹•æ¨å®š
- **ğŸ“„ PDFãƒ¬ãƒãƒ¼ãƒˆ**: ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªPDFãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆ
- **ğŸ˜ï¸ åœ°ä¾¡å…¬ç¤ºãƒ‡ãƒ¼ã‚¿**: æœ€æ–°5å¹´åˆ†ã®é‘‘å®šè©•ä¾¡æ›¸æƒ…å ±ã‚’æ´»ç”¨
- **ğŸ¤– AIåˆ†æ**: OpenAI GPT-4ã«ã‚ˆã‚‹é«˜åº¦ãªå¸‚å ´åˆ†æï¼ˆå®Ÿè£…äºˆå®šï¼‰
- **ğŸ“± PWAå¯¾å¿œ**: ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¯èƒ½ã€ã‚ªãƒ•ãƒ©ã‚¤ãƒ³æ©Ÿèƒ½æ­è¼‰

## ğŸš€ ãƒ‡ãƒ¢

**Sandboxç’°å¢ƒ**: [https://3000-i1kyslh8gn8plpo5b4s6r-b9b802c4.sandbox.novita.ai](https://3000-i1kyslh8gn8plpo5b4s6r-b9b802c4.sandbox.novita.ai)

**GitHub ãƒªãƒã‚¸ãƒˆãƒª**: [https://github.com/koki-187/My-Agent-Analitics-genspark](https://github.com/koki-187/My-Agent-Analitics-genspark)

**å…ƒã®Next.jsãƒªãƒã‚¸ãƒˆãƒª**: [https://github.com/koki-187/My-Agent-analytics](https://github.com/koki-187/My-Agent-analytics)

## ğŸ“‹ ç¾åœ¨ã®å®Ÿè£…çŠ¶æ³

### âœ… å®Ÿè£…æ¸ˆã¿æ©Ÿèƒ½

#### Phase 1: åŸºç›¤æ§‹ç¯‰
- [x] Hono ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã«ã‚ˆã‚‹ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
- [x] ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãªãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒšãƒ¼ã‚¸
- [x] API ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
- [x] PWA ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆ
- [x] Service Workerï¼ˆã‚ªãƒ•ãƒ©ã‚¤ãƒ³å¯¾å¿œï¼‰
- [x] é™çš„ãƒ•ã‚¡ã‚¤ãƒ«é…ä¿¡
- [x] TypeScript å®Œå…¨å¯¾å¿œ
- [x] Vite ãƒ“ãƒ«ãƒ‰ã‚·ã‚¹ãƒ†ãƒ 

#### Phase 2: èªè¨¼ã‚·ã‚¹ãƒ†ãƒ 
- [x] Google OAuth èªè¨¼ãƒ•ãƒ­ãƒ¼
- [x] ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ï¼ˆCookie-basedï¼‰
- [x] èªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢
- [x] ãƒ­ã‚°ã‚¤ãƒ³/ãƒ­ã‚°ã‚¢ã‚¦ãƒˆæ©Ÿèƒ½
- [x] ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†
- [x] **è¨­å®šãƒšãƒ¼ã‚¸** - APIã‚­ãƒ¼è¨­å®šçŠ¶æ³ã®å¯è¦–åŒ– ğŸ†•

#### Phase 3: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±åˆ
- [x] Cloudflare D1 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
- [x] ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒè¨­è¨ˆï¼ˆ7ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰
- [x] ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç®¡ç†
- [x] CRUDæ“ä½œãƒ©ã‚¤ãƒ–ãƒ©ãƒª
- [x] ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ãƒ†ãƒ¼ãƒ–ãƒ«

#### Phase 4: æŠ•è³‡æŒ‡æ¨™è¨ˆç®—
- [x] **æŠ•è³‡æŒ‡æ¨™è¨ˆç®—ã‚¨ãƒ³ã‚¸ãƒ³**
  - NOIï¼ˆç´”å–¶æ¥­åˆ©ç›Šï¼‰
  - è¡¨é¢åˆ©å›ã‚Š/å®Ÿè³ªåˆ©å›ã‚Š
  - DSCRï¼ˆå‚µå‹™å„Ÿé‚„ã‚«ãƒãƒ¼ç‡ï¼‰
  - LTVï¼ˆãƒ­ãƒ¼ãƒ³å¯¾ç‰©ä»¶ä¾¡å€¤æ¯”ç‡ï¼‰
  - CCRï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ»ã‚ªãƒ³ãƒ»ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ»ãƒªã‚¿ãƒ¼ãƒ³ï¼‰
  - BERï¼ˆæç›Šåˆ†å²ç‚¹æ¯”ç‡ï¼‰
  - ãƒªã‚¹ã‚¯è©•ä¾¡ã¨ãƒ¬ã‚³ãƒ¡ãƒ³ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

#### Phase 5: ä¸å‹•ç”£æƒ…å ±ãƒ©ã‚¤ãƒ–ãƒ©ãƒªAPIçµ±åˆ ğŸ†•
- [x] **å›½åœŸäº¤é€šçœ ä¸å‹•ç”£æƒ…å ±ãƒ©ã‚¤ãƒ–ãƒ©ãƒªAPI**
  - ä¸å‹•ç”£å–å¼•ä¾¡æ ¼æƒ…å ±å–å¾—ï¼ˆ2005å¹´ï½ï¼‰
  - åœ°ä¾¡å…¬ç¤ºãƒ»é‘‘å®šè©•ä¾¡æ›¸æƒ…å ±ï¼ˆ2021ï½2025å¹´ï¼‰
  - å¸‚åŒºç”ºæ‘ä¸€è¦§å–å¾—
  - å¸‚å ´å‹•å‘åˆ†æï¼ˆä¾¡æ ¼ãƒˆãƒ¬ãƒ³ãƒ‰ã€å–å¼•ä»¶æ•°ï¼‰
  - å‘¨è¾ºå–å¼•äº‹ä¾‹æ¤œç´¢ï¼ˆé¡ä¼¼ç‰©ä»¶æ¤œç´¢ï¼‰
  - ä¾¡æ ¼æ¨å®šæ©Ÿèƒ½ï¼ˆå®Ÿå–å¼•ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼‰

- [x] **å¸‚å ´åˆ†æAPI ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**
  - POST `/api/market/analyze` - å¸‚å ´å‹•å‘åˆ†æ
  - GET `/api/market/trade-prices` - å–å¼•ä¾¡æ ¼æƒ…å ±å–å¾—
  - GET `/api/market/land-prices` - åœ°ä¾¡å…¬ç¤ºãƒ‡ãƒ¼ã‚¿å–å¾—
  - GET `/api/market/municipalities` - å¸‚åŒºç”ºæ‘ä¸€è¦§å–å¾—
  - POST `/api/market/comparables` - å‘¨è¾ºå–å¼•äº‹ä¾‹æ¤œç´¢
  - POST `/api/market/estimate-price` - ç‰©ä»¶ä¾¡æ ¼æ¨å®š

- [x] **ç‰©ä»¶ç®¡ç†API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**
  - POST `/api/properties/analyze` - è²¡å‹™åˆ†æ
  - GET `/api/properties` - ç‰©ä»¶ä¸€è¦§å–å¾—
  - GET `/api/properties/:id` - ç‰©ä»¶è©³ç´°å–å¾—

### ğŸ”„ å®Ÿè£…ä¸­

- [ ] ãƒ‡ãƒ¼ã‚¿å¯è¦–åŒ–ï¼ˆã‚°ãƒ©ãƒ•ãƒ»ãƒãƒ£ãƒ¼ãƒˆï¼‰
- [ ] PDF ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
- [ ] ã‚¤ã‚¿ãƒ³ã‚¸APIçµ±åˆ
- [ ] ãƒ¬ã‚¤ãƒ³ã‚ºãƒ‡ãƒ¼ã‚¿çµ±åˆ

### ğŸ“ ä»Šå¾Œã®å®Ÿè£…äºˆå®š

- [ ] e-Stat API çµ±åˆï¼ˆäººå£çµ±è¨ˆã€çµŒæ¸ˆæŒ‡æ¨™ï¼‰
- [ ] OpenAI GPT-4 çµ±åˆï¼ˆAIå¸‚å ´åˆ†æï¼‰
- [ ] ç‰©ä»¶æ¯”è¼ƒæ©Ÿèƒ½
- [ ] æŠ•è³‡ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
- [ ] OpenAI API çµ±åˆï¼ˆAIåˆ†æï¼‰
- [ ] ãƒ¬ãƒãƒ¼ãƒˆå…±æœ‰æ©Ÿèƒ½
- [ ] è¤‡æ•°ç‰©ä»¶ã®æ¯”è¼ƒæ©Ÿèƒ½

## ğŸ› ï¸ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
- **ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯**: Hono (Cloudflare Workers)
- **ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°**: Tailwind CSS (CDN)
- **ã‚¢ã‚¤ã‚³ãƒ³**: Font Awesome
- **ãƒ•ã‚©ãƒ³ãƒˆ**: Noto Sans JP

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
- **ãƒ©ãƒ³ã‚¿ã‚¤ãƒ **: Cloudflare Workers
- **API**: Hono REST API
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: Cloudflare D1 (SQLite)
- **ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸**: Cloudflare R2
- **ã‚­ãƒ£ãƒƒã‚·ãƒ¥**: Cloudflare KV

### é–‹ç™ºãƒ„ãƒ¼ãƒ«
- **è¨€èª**: TypeScript 5.0
- **ãƒ“ãƒ«ãƒ‰**: Vite
- **ãƒ‡ãƒ—ãƒ­ã‚¤**: Wrangler CLI
- **ãƒ—ãƒ­ã‚»ã‚¹ç®¡ç†**: PM2 (é–‹ç™ºç’°å¢ƒ)

## ğŸ“¦ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

### å¿…è¦è¦ä»¶

- Node.js 18.x ä»¥ä¸Š
- npm ã¾ãŸã¯ yarn
- Cloudflare ã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆãƒ‡ãƒ—ãƒ­ã‚¤ç”¨ï¼‰

### ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †

1. **ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³**

```bash
git clone https://github.com/koki-187/My-Agent-Analitics-genspark.git
cd My-Agent-Analitics-genspark
```

2. **ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**

```bash
npm install
```

3. **ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®š**

âš ï¸ **é‡è¦**: APIã‚­ãƒ¼ã®è¨­å®šãŒå¿…è¦ã§ã™

```bash
# APIã‚­ãƒ¼è¨­å®šçŠ¶æ³ã‚’ç¢ºèª
bash check-api-keys.sh

# .dev.vars ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†
# è©³ç´°ãªè¨­å®šæ–¹æ³•ã¯ API_KEY_SETUP.md ã‚’å‚ç…§
```

**å¿…é ˆAPIã‚­ãƒ¼:**
- `GOOGLE_CLIENT_ID` / `GOOGLE_CLIENT_SECRET` - ãƒ­ã‚°ã‚¤ãƒ³æ©Ÿèƒ½
- `REINFOLIB_API_KEY` - å¸‚å ´åˆ†ææ©Ÿèƒ½
- `SESSION_SECRET` - ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†

**ğŸ“– è©³ç´°ã‚¬ã‚¤ãƒ‰**: [API_KEY_SETUP.md](./API_KEY_SETUP.md) ã‚’å‚ç…§

4. **ãƒ“ãƒ«ãƒ‰**

```bash
npm run build
```

5. **é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•**

```bash
# PM2ã§èµ·å‹•ï¼ˆæ¨å¥¨ï¼‰
pm2 start ecosystem.config.cjs

# ã¾ãŸã¯ç›´æ¥èµ·å‹•
npm run dev:sandbox
```

6. **ãƒ–ãƒ©ã‚¦ã‚¶ã§ç¢ºèª**

http://localhost:3000 ã‚’é–‹ã

## ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤

### Cloudflare Pages ã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤

1. **Cloudflare API ãƒˆãƒ¼ã‚¯ãƒ³ã‚’è¨­å®š**

```bash
# GenSpark ã§ setup_cloudflare_api_key ã‚’å®Ÿè¡Œ
```

2. **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒ“ãƒ«ãƒ‰**

```bash
npm run build
```

3. **Cloudflare Pages ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ**

```bash
npx wrangler pages project create my-agent-analytics \
  --production-branch main
```

4. **ãƒ‡ãƒ—ãƒ­ã‚¤**

```bash
npm run deploy:prod
```

5. **ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®š**

**å¿…é ˆAPIã‚­ãƒ¼:**
```bash
# Google OAuthï¼ˆãƒ­ã‚°ã‚¤ãƒ³æ©Ÿèƒ½ï¼‰
npx wrangler pages secret put GOOGLE_CLIENT_ID --project-name my-agent-analytics
npx wrangler pages secret put GOOGLE_CLIENT_SECRET --project-name my-agent-analytics

# ä¸å‹•ç”£æƒ…å ±ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆå¸‚å ´åˆ†æï¼‰
npx wrangler pages secret put REINFOLIB_API_KEY --project-name my-agent-analytics

# ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†
npx wrangler pages secret put SESSION_SECRET --project-name my-agent-analytics
```

**ä»»æ„ã®APIã‚­ãƒ¼:**
```bash
# OpenAIï¼ˆAIåˆ†ææ©Ÿèƒ½ï¼‰
npx wrangler pages secret put OPENAI_API_KEY --project-name my-agent-analytics

# e-Statï¼ˆæ”¿åºœçµ±è¨ˆãƒ‡ãƒ¼ã‚¿ï¼‰
npx wrangler pages secret put ESTAT_API_KEY --project-name my-agent-analytics

# ã‚¤ã‚¿ãƒ³ã‚¸ï¼ˆè³ƒè²¸ç‰©ä»¶æƒ…å ±ï¼‰
npx wrangler pages secret put ITANDI_API_KEY --project-name my-agent-analytics

# ãƒ¬ã‚¤ãƒ³ã‚ºï¼ˆä¸å‹•ç”£æµé€šæƒ…å ±ï¼‰
npx wrangler pages secret put REINS_LOGIN_ID --project-name my-agent-analytics
npx wrangler pages secret put REINS_PASSWORD --project-name my-agent-analytics
```

**ğŸ“– å„APIã‚­ãƒ¼ã®å–å¾—æ–¹æ³•**: [API_KEY_SETUP.md](./API_KEY_SETUP.md) ã‚’å‚ç…§

## ğŸ“– APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

### ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯

```http
GET /api/health
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹:**
```json
{
  "status": "ok",
  "timestamp": "2024-01-01T00:00:00.000Z",
  "version": "2.0.0"
}
```

### ç‰©ä»¶è²¡å‹™åˆ†æ

```http
POST /api/properties/analyze
Content-Type: application/json
```

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£:**
```json
{
  "propertyPrice": 50000000,
  "grossIncome": 5000000,
  "effectiveIncome": 4800000,
  "operatingExpenses": 1000000,
  "loanAmount": 40000000,
  "interestRate": 2.5,
  "loanTerm": 30,
  "downPayment": 10000000
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹:**
```json
{
  "success": true,
  "analysis": {
    "noi": 3800000,
    "grossYield": 10,
    "netYield": 7.6,
    "dscr": 1.89,
    "ltv": 80,
    "ccr": 38,
    "ber": 20,
    "operatingExpenseRatio": 20,
    "annualDebtService": 2013194,
    "monthlyCashFlow": 316666.67,
    "annualCashFlow": 3800000,
    "riskLevel": "medium",
    "riskFactors": ["LTV ãŒã‚„ã‚„é«˜ã„ï¼ˆ70%è¶…ï¼‰"],
    "recommendations": ["è‡ªå·±è³‡é‡‘ã‚’å¢—ã‚„ã—ã¦LTVã‚’ä¸‹ã’ã‚‹ã“ã¨ã‚’æ¤œè¨"]
  }
}
```

### å¸‚å ´å‹•å‘åˆ†æ ğŸ†•

```http
POST /api/market/analyze
Content-Type: application/json
```

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£:**
```json
{
  "year": 2024,
  "area": "13",
  "city": "13102"
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹:**
```json
{
  "success": true,
  "analysis": {
    "area": "13102",
    "averagePrice": 45000000,
    "averagePricePerSquareMeter": 850000,
    "transactionCount": 156,
    "priceRange": {
      "min": 20000000,
      "max": 120000000,
      "median": 42000000
    },
    "pricetrend": {
      "currentQuarter": 45000000,
      "previousQuarter": 43500000,
      "changeRate": 3.45
    },
    "popularPropertyTypes": [
      { "type": "ãƒãƒ³ã‚·ãƒ§ãƒ³", "count": 98, "percentage": 62.8 }
    ]
  }
}
```

### ä¸å‹•ç”£å–å¼•ä¾¡æ ¼å–å¾— ğŸ†•

```http
GET /api/market/trade-prices?year=2024&area=13&city=13102
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹:**
```json
{
  "success": true,
  "status": "success",
  "data": [
    {
      "Type": "ä¸­å¤ãƒãƒ³ã‚·ãƒ§ãƒ³ç­‰",
      "TradePrice": "45000000",
      "Area": "65",
      "UnitPrice": "692000",
      "Period": "2024å¹´ç¬¬2å››åŠæœŸ",
      "Municipality": "ä¸­å¤®åŒº"
    }
  ]
}
```

### åœ°ä¾¡å…¬ç¤ºãƒ‡ãƒ¼ã‚¿å–å¾— ğŸ†•

```http
GET /api/market/land-prices?year=2024&area=13&division=00
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹:** åœ°ä¾¡å…¬ç¤ºã®è©³ç´°ãƒ‡ãƒ¼ã‚¿ï¼ˆæ¨™æº–åœ°ã€ä¾¡æ ¼ã€ç”¨é€”åœ°åŸŸç­‰ï¼‰

### ä¾¡æ ¼æ¨å®š ğŸ†•

```http
POST /api/market/estimate-price
Content-Type: application/json
```

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£:**
```json
{
  "city": "13102",
  "area": 65,
  "propertyType": "ä¸­å¤ãƒãƒ³ã‚·ãƒ§ãƒ³ç­‰",
  "buildingYear": "å¹³æˆ15å¹´"
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹:**
```json
{
  "success": true,
  "estimation": {
    "estimatedPrice": 46200000,
    "pricePerSquareMeter": 710000,
    "confidence": "high",
    "comparableCount": 15,
    "priceRange": {
      "min": 40000000,
      "max": 52000000
    }
  }
}
```

### å‘¨è¾ºå–å¼•äº‹ä¾‹æ¤œç´¢ ğŸ†•

```http
POST /api/market/comparables
Content-Type: application/json
```

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£:**
```json
{
  "city": "13102",
  "propertyType": "ä¸­å¤ãƒãƒ³ã‚·ãƒ§ãƒ³ç­‰",
  "minArea": 55,
  "maxArea": 75,
  "limit": 10
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹:**
```json
{
  "success": true,
  "data": [...],
  "count": 10
}
```

### ç‰©ä»¶ä¸€è¦§å–å¾—

```http
GET /api/properties
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹:**
```json
{
  "success": true,
  "properties": [
    {
      "id": "prop_1",
      "name": "æµæ¯”å¯¿ãƒ¬ã‚¸ãƒ‡ãƒ³ã‚¹",
      "address": "æ±äº¬éƒ½æ¸‹è°·åŒºæµæ¯”å¯¿1-1-1",
      "price": 50000000,
      "created_at": "2024-01-01T00:00:00.000Z"
    }
  ]
}
```

## ğŸ—‚ï¸ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

```
my-agent-analytics/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.tsx              # ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â””â”€â”€ index.ts           # TypeScriptå‹å®šç¾©
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ utils.ts           # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
â”‚   â”‚   â”œâ”€â”€ db.ts              # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œ
â”‚   â”‚   â”œâ”€â”€ calculator.ts      # æŠ•è³‡æŒ‡æ¨™è¨ˆç®—ã‚¨ãƒ³ã‚¸ãƒ³
â”‚   â”‚   â””â”€â”€ reinfolib.ts       # ä¸å‹•ç”£æƒ…å ±ãƒ©ã‚¤ãƒ–ãƒ©ãƒªAPIçµ±åˆ
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€â”€ auth.tsx           # èªè¨¼ãƒ«ãƒ¼ãƒˆ
â”‚   â”‚   â”œâ”€â”€ dashboard.tsx      # ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
â”‚   â”‚   â”œâ”€â”€ settings.tsx       # è¨­å®šãƒšãƒ¼ã‚¸ï¼ˆAPIã‚­ãƒ¼ç®¡ç†ï¼‰ ğŸ†•
â”‚   â”‚   â”œâ”€â”€ properties.tsx     # ç‰©ä»¶ç®¡ç†UI
â”‚   â”‚   â””â”€â”€ api.tsx            # API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
â”‚   â””â”€â”€ middleware/
â”‚       â””â”€â”€ auth.ts            # èªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ static/
â”‚   â”‚   â”œâ”€â”€ icons/             # PWAã‚¢ã‚¤ã‚³ãƒ³
â”‚   â”‚   â””â”€â”€ manifest.json      # PWAãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆ
â”‚   â””â”€â”€ sw.js                  # Service Worker
â”œâ”€â”€ migrations/                # D1ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
â”‚   â””â”€â”€ 0001_initial_schema.sql
â”œâ”€â”€ docs/                      # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ PROJECT_OVERVIEW.md
â”‚   â””â”€â”€ MIGRATION_PLAN.md
â”œâ”€â”€ nextjs-backup/             # Next.jsç‰ˆã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
â”œâ”€â”€ dist/                      # ãƒ“ãƒ«ãƒ‰å‡ºåŠ›
â”œâ”€â”€ wrangler.jsonc             # Cloudflareè¨­å®š
â”œâ”€â”€ vite.config.ts             # Viteãƒ“ãƒ«ãƒ‰è¨­å®š
â”œâ”€â”€ tsconfig.json              # TypeScriptè¨­å®š
â”œâ”€â”€ ecosystem.config.cjs       # PM2è¨­å®š
â”œâ”€â”€ seed.sql                   # ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿
â”œâ”€â”€ package.json
â””â”€â”€ README.md
```

## ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

- **API Keyç®¡ç†**: ã™ã¹ã¦ã®APIã‚­ãƒ¼ã¯Cloudflare Secretsã§ç®¡ç†
- **èªè¨¼**: Google OAuthã«ã‚ˆã‚‹å®‰å…¨ãªèªè¨¼
- **HTTPS**: ã™ã¹ã¦ã®é€šä¿¡ã¯HTTPSã§æš—å·åŒ–
- **CORS**: é©åˆ‡ãªCORSè¨­å®š

## ğŸ“Š ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

- âš¡ **APIå¿œç­”æ™‚é–“**: < 500ms
- ğŸ¯ **åˆå›è¡¨ç¤º**: < 2ç§’
- ğŸ“ˆ **Lighthouse ã‚¹ã‚³ã‚¢**: ç›®æ¨™ 90ç‚¹ä»¥ä¸Š
- ğŸŒ **ã‚°ãƒ­ãƒ¼ãƒãƒ«CDN**: Cloudflare ã®200+ãƒ‡ãƒ¼ã‚¿ã‚»ãƒ³ã‚¿ãƒ¼

## ğŸ¤ ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³

ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’æ­“è¿ã—ã¾ã™ï¼å¤§ããªå¤‰æ›´ã®å ´åˆã¯ã€ã¾ãšissueã‚’é–‹ã„ã¦å¤‰æ›´å†…å®¹ã‚’è­°è«–ã—ã¦ãã ã•ã„ã€‚

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ [MIT ãƒ©ã‚¤ã‚»ãƒ³ã‚¹](LICENSE) ã®ä¸‹ã§å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚

## ğŸ”— é–¢é€£ãƒªãƒ³ã‚¯

- [Hono ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://hono.dev/)
- [Cloudflare Workers ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://developers.cloudflare.com/workers/)
- [Cloudflare Pages ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://developers.cloudflare.com/pages/)
- [e-Stat API](https://www.e-stat.go.jp/api/)
- [OpenAI API](https://platform.openai.com/docs/)

## ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã«å¤‰æ›´ãŒåæ˜ ã•ã‚Œãªã„

**åŸå› **: ãƒ–ãƒ©ã‚¦ã‚¶ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¾ãŸã¯ãƒ“ãƒ«ãƒ‰ã‚­ãƒ£ãƒƒã‚·ãƒ¥

**è§£æ±ºæ–¹æ³•:**
```bash
# 1. ãƒ“ãƒ«ãƒ‰ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢
cd /home/user/webapp
rm -rf dist .wrangler

# 2. å†ãƒ“ãƒ«ãƒ‰
npm run build

# 3. PM2ã‚’å®Œå…¨å†èµ·å‹•
pm2 delete all
pm2 start ecosystem.config.cjs

# 4. ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒªãƒ­ãƒ¼ãƒ‰
# - Chrome/Edge: Ctrl + Shift + R (Windows) / Cmd + Shift + R (Mac)
# - Firefox: Ctrl + F5 (Windows) / Cmd + Shift + R (Mac)
```

### APIã‚­ãƒ¼ãŒèª­ã¿è¾¼ã¾ã‚Œãªã„

**ç¢ºèªæ–¹æ³•:**
```bash
# APIã‚­ãƒ¼è¨­å®šçŠ¶æ³ã‚’ç¢ºèª
bash check-api-keys.sh

# PM2ãƒ­ã‚°ã‚’ç¢ºèª
pm2 logs my-agent-analytics --nostream
```

**ã¾ãŸã¯ Web UI ã§ç¢ºèª:**
- ãƒ­ã‚°ã‚¤ãƒ³å¾Œã€å³ä¸Šã®âš™ï¸ã‚¢ã‚¤ã‚³ãƒ³ã‹ã‚‰è¨­å®šãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹
- å„APIã‚­ãƒ¼ã®è¨­å®šçŠ¶æ³ã‚’ç¢ºèª
- å¿…è¦ãªAPIã‚­ãƒ¼ã®å–å¾—æ–¹æ³•ã‚‚è¡¨ç¤ºã•ã‚Œã¾ã™

**è§£æ±ºæ–¹æ³•:**
1. `.dev.vars` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèª
2. APIã‚­ãƒ¼ã«ä½™è¨ˆãªç©ºç™½ã‚„ã‚¯ã‚©ãƒ¼ãƒˆãŒãªã„ã‹ç¢ºèª
3. PM2ã‚’å†èµ·å‹•: `pm2 restart my-agent-analytics`

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼

**è§£æ±ºæ–¹æ³•:**
```bash
# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ãƒªã‚»ãƒƒãƒˆ
npm run db:reset

# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å†å®Ÿè¡Œ
npm run db:migrate:local
```

### ãã®ä»–ã®å•é¡Œ

è©³ç´°ãªãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã¯ä»¥ä¸‹ã‚’å‚ç…§:
- **APIã‚­ãƒ¼é–¢é€£**: [API_KEY_SETUP.md](./API_KEY_SETUP.md)
- **æŠ€è¡“çš„ãªå•é¡Œ**: [GitHubã®Issue](https://github.com/koki-187/My-Agent-Analitics-genspark/issues)

## ğŸ“ ã‚µãƒãƒ¼ãƒˆ

å•é¡ŒãŒè§£æ±ºã—ãªã„å ´åˆã¯ã€[GitHubã®Issue](https://github.com/koki-187/My-Agent-Analitics-genspark/issues)ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

**å¿…è¦æƒ…å ±:**
- ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
- å®Ÿè¡Œã—ãŸã‚³ãƒãƒ³ãƒ‰
- ç’°å¢ƒï¼ˆãƒ­ãƒ¼ã‚«ãƒ«/Sandbox/æœ¬ç•ªï¼‰
- ãƒ–ãƒ©ã‚¦ã‚¶ã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³

---

**é–‹ç™ºãƒãƒ¼ãƒ **: My Agent Team  
**æœ€çµ‚æ›´æ–°**: 2025å¹´10æœˆ30æ—¥  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 2.1.0
