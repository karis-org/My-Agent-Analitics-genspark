# My Agent Analytics

**AIã‚’æ´»ç”¨ã—ãŸä¸å‹•ç”£æŠ•è³‡åˆ†æã‚·ã‚¹ãƒ†ãƒ **

[![Cloudflare Pages](https://img.shields.io/badge/Cloudflare-Pages-orange)](https://pages.cloudflare.com/)
[![Hono](https://img.shields.io/badge/Framework-Hono-blue)](https://hono.dev/)
[![TypeScript](https://img.shields.io/badge/TypeScript-5.0-blue)](https://www.typescriptlang.org/)
[![License](https://img.shields.io/badge/License-MIT-green)](LICENSE)

## ğŸ¯ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

My Agent Analyticsã¯ã€ä¸å‹•ç”£ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¨æŠ•è³‡å®¶å‘ã‘ã®åŒ…æ‹¬çš„ãªãƒ‡ãƒ¼ã‚¿åˆ†æãƒ»ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆãƒ„ãƒ¼ãƒ«ã§ã™ã€‚ç‰©ä»¶ãƒ‡ãƒ¼ã‚¿ã‚’å…¥åŠ›ã™ã‚‹ã ã‘ã§ã€AIã¨æ”¿åºœçµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’æ´»ç”¨ã—ãŸè©³ç´°ãªå¸‚å ´åˆ†æãƒ¬ãƒãƒ¼ãƒˆã‚’è‡ªå‹•ç”Ÿæˆã—ã¾ã™ã€‚

**ğŸš€ é¢å€’ãªè¨­å®šã¯ä¸€åˆ‡ä¸è¦ï¼ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹ã ã‘ã§ã™ãã«ä½¿ãˆã¾ã™ã€‚**

## ğŸŒ ãƒ‡ãƒ¢ãƒ»æœ¬ç•ªç’°å¢ƒ

**ğŸš€ æœ¬ç•ªç’°å¢ƒï¼ˆæœ€æ–°ï¼‰**: [https://b69092e6.my-agent-analytics.pages.dev](https://b69092e6.my-agent-analytics.pages.dev)  
âœ¨ **Session 2å®Œäº†ç‰ˆ - Google Custom Search APIçµ±åˆãƒ»ã‚³ã‚¹ãƒˆæƒ…å ±è¿½åŠ ãƒ»UIæ”¹å–„å®Œäº†** ğŸ‰

**ğŸŒ æœ¬ç•ªURL**: [https://my-agent-analytics.pages.dev](https://my-agent-analytics.pages.dev)

**ğŸš€ æœ¬ç•ªç’°å¢ƒï¼ˆå‰ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼‰**: [https://344024d1.my-agent-analytics.pages.dev](https://344024d1.my-agent-analytics.pages.dev)  

**GitHub ãƒªãƒã‚¸ãƒˆãƒª**: [https://github.com/koki-187/My-Agent-Analitics-genspark](https://github.com/koki-187/My-Agent-Analitics-genspark)

## ğŸŒŸ ä¸»ãªç‰¹å¾´

### æŠ•è³‡åˆ†æ
- **ğŸ“Š è‡ªå‹•è¨ˆç®—**: NOIã€åˆ©å›ã‚Šã€DSCRã€LTVãªã©ã®æŠ•è³‡æŒ‡æ¨™ã‚’è‡ªå‹•ç®—å‡º
- **ğŸ’° åç›Šæ€§è©•ä¾¡**: ç‰©ä»¶ä¾¡æ ¼ã€æƒ³å®šå®¶è³ƒåå…¥ã€ç¨¼åƒç‡ã€ãƒ­ãƒ¼ãƒ³æ¡ä»¶ã‹ã‚‰åç›Šæ€§ã‚’åˆ†æ
- **ğŸ“ˆ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ•ãƒ­ãƒ¼äºˆæ¸¬**: æœˆæ¬¡ãƒ»å¹´æ¬¡ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ•ãƒ­ãƒ¼è©³ç´°è¨ˆç®—
- **âš–ï¸ ãƒªã‚¹ã‚¯è©•ä¾¡**: DSCRã€LTVã€BERã«åŸºã¥ãç·åˆãƒªã‚¹ã‚¯åˆ¤å®š

### å¸‚å ´åˆ†æãƒ»ãƒ‡ãƒ¼ã‚¿é€£æº
- **ğŸ˜ï¸ å®Ÿãƒ‡ãƒ¼ã‚¿åˆ†æ**: å›½åœŸäº¤é€šçœã®å®Ÿå–å¼•ä¾¡æ ¼ãƒ‡ãƒ¼ã‚¿ã§å¸‚å ´å‹•å‘ã‚’åˆ†æ
- **ğŸ¢ ä¾¡æ ¼æ¨å®š**: å‘¨è¾ºå–å¼•äº‹ä¾‹ã‹ã‚‰ç‰©ä»¶ä¾¡æ ¼ã‚’è‡ªå‹•æ¨å®š
- **ğŸ“Š åœ°ä¾¡å…¬ç¤ºãƒ‡ãƒ¼ã‚¿**: æœ€æ–°5å¹´åˆ†ã®é‘‘å®šè©•ä¾¡æ›¸æƒ…å ±ã‚’æ´»ç”¨
- **ğŸ“Š è³ƒè²¸ç›¸å ´åˆ†æ**: ã‚¤ã‚¿ãƒ³ã‚¸BB APIã«ã‚ˆã‚‹è³ƒè²¸å¸‚å ´åˆ†æï¼ˆã‚¨ãƒªã‚¢æ¤œç´¢ã€æ¨ç§»ã‚°ãƒ©ãƒ•ï¼‰
- **ğŸ¤– AIåˆ†æ**: OpenAI GPT-4oã«ã‚ˆã‚‹é«˜åº¦ãªå¸‚å ´åˆ†æï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰
- **ğŸ“Š æ”¿åºœçµ±è¨ˆãƒ‡ãƒ¼ã‚¿**: e-Stat APIã«ã‚ˆã‚‹äººå£çµ±è¨ˆãƒ»çµŒæ¸ˆæŒ‡æ¨™å–å¾—

### ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆãƒ»å‡ºåŠ›
- **ğŸ“‹ çµ±åˆãƒ¬ãƒãƒ¼ãƒˆ**: ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§å…¨åˆ†æçµæœã‚’1ãƒšãƒ¼ã‚¸ã«çµ±åˆè¡¨ç¤º
- **ğŸ“„ PDFãƒ¬ãƒãƒ¼ãƒˆ**: ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªPDFãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆ
- **âœï¸ ãƒ¬ãƒãƒ¼ãƒˆç·¨é›†**: ã‚¯ãƒªãƒƒã‚¯ã§ç›´æ¥ç·¨é›†ã€é¡§å®¢å‘ã‘ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º
- **ğŸ¨ æœªæ¥çš„UI**: ã‚°ãƒ©ã‚¹ãƒ¢ãƒ¼ãƒ•ã‚£ã‚ºãƒ  + ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
- **ğŸ–¨ï¸ å°åˆ·å¯¾å¿œ**: ãƒ–ãƒ©ã‚¦ã‚¶å°åˆ·æ©Ÿèƒ½å®Œå…¨å¯¾å¿œ

### ãã®ä»–æ©Ÿèƒ½
- **ğŸ” äº‹æ•…ç‰©ä»¶èª¿æŸ»**: **Google Custom Search API + OpenAI GPT-4 çµ±åˆ**ã«ã‚ˆã‚‹é«˜ç²¾åº¦ãªå¿ƒç†çš„ç‘•ç–µèª¿æŸ»ã‚·ã‚¹ãƒ†ãƒ 
  - å®Ÿéš›ã®ã‚¦ã‚§ãƒ–æ¤œç´¢ã§å¤§å³¶ã¦ã‚‹ã€ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚µã‚¤ãƒˆç­‰ã‚’æ¤œç´¢
  - AIåˆ†æã«ã‚ˆã‚‹å½é™°æ€§ï¼ˆfalse negativeï¼‰æ’é™¤
  - èª¿æŸ»è²»ç”¨æƒ…å ±è¡¨ç¤ºï¼ˆ22,000ã€œ55,000å††/æˆ¸ï¼‰
- **âœ… ãƒ•ã‚¡ã‚¯ãƒˆãƒã‚§ãƒƒã‚¯**: ãƒ¬ãƒãƒ¼ãƒˆæ¤œè¨¼ã¨AIç¢ºèªæ©Ÿèƒ½
- **ğŸ—ºï¸ Googleãƒãƒƒãƒ—çµ±åˆ**: ç‰©ä»¶å‘¨è¾ºåœ°å›³è‡ªå‹•ç”Ÿæˆï¼ˆ1km/200m ã‚¹ã‚±ãƒ¼ãƒ«ã€A4æ¨ªå‘ãï¼‰
- **ğŸ”„ ãƒ‡ãƒ¼ã‚¿æ¨ªæ–­åˆ©ç”¨**: æ–°è¦ç‰©ä»¶ç™»éŒ²æ™‚ã«è¤‡æ•°åˆ†æã‚’ä¸¦è¡Œå®Ÿè¡Œ
- **ğŸ“± PWAå¯¾å¿œ**: ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¯èƒ½ã€ã‚ªãƒ•ãƒ©ã‚¤ãƒ³æ©Ÿèƒ½æ­è¼‰

## âœ… å®Ÿè£…æ¸ˆã¿æ©Ÿèƒ½ï¼ˆé‡è¦ï¼‰

### ç‰©ä»¶ç®¡ç†ãƒ»åˆ†æ
- âœ… **ç‰©ä»¶åç›Šãƒ‡ãƒ¼ã‚¿å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ** (`/properties/:id/analyze`)
  - ç‰©ä»¶ä¾¡æ ¼ã€æƒ³å®šå®¶è³ƒåå…¥ã€ç¨¼åƒç‡ã€å¹´é–“çµŒè²»
  - ãƒ­ãƒ¼ãƒ³å€Ÿå…¥é¡ã€é‡‘åˆ©ã€è¿”æ¸ˆæœŸé–“ã€è‡ªå·±è³‡é‡‘
- âœ… **çµ±åˆåˆ†æãƒ¬ãƒãƒ¼ãƒˆãƒšãƒ¼ã‚¸** (`/properties/:id/comprehensive-report`)
  - ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã€ã‚°ãƒ©ã‚¹ãƒ¢ãƒ¼ãƒ•ã‚£ã‚ºãƒ ãƒ‡ã‚¶ã‚¤ãƒ³
  - å…¨åˆ†æçµæœã®çµ±åˆè¡¨ç¤ºã€Chart.jsã‚°ãƒ©ãƒ•ã€PDF/å°åˆ·æ©Ÿèƒ½
- âœ… **ã‚¤ã‚¿ãƒ³ã‚¸BB è³ƒè²¸ç›¸å ´åˆ†æ** (`/itandi/rental-market`)
  - åœ°åŸŸæ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ ã€è³ƒæ–™ç›¸å ´åˆ†æã€ã‚°ãƒ©ãƒ•è¡¨ç¤ºã€ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œ
- âœ… **åˆ†æå®Ÿè¡Œãƒšãƒ¼ã‚¸** (`/properties/:id/analyze`)
  - è²¡å‹™åˆ†æãƒ•ã‚©ãƒ¼ãƒ ã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¨ˆç®—ã€çµæœè¡¨ç¤º

### APIãƒ»ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
- âœ… ç‰©ä»¶CRUD APIï¼ˆç™»éŒ²ãƒ»æ›´æ–°ãƒ»å‰Šé™¤ãƒ»ä¸€è¦§å–å¾—ï¼‰
- âœ… è²¡å‹™åˆ†æAPIï¼ˆè‡ªå‹•ä¿å­˜å¯¾å¿œï¼‰
- âœ… å¸‚å ´åˆ†æAPIï¼ˆå›½åœŸäº¤é€šçœãƒ‡ãƒ¼ã‚¿ï¼‰
- âœ… AIåˆ†æAPIï¼ˆOpenAI GPT-4oçµ±åˆï¼‰
- âœ… ã‚¤ã‚¿ãƒ³ã‚¸BB APIï¼ˆè³ƒè²¸ç›¸å ´åˆ†æï¼‰
- âœ… Cloudflare D1 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆ7ãƒ†ãƒ¼ãƒ–ãƒ«ã€2ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³é©ç”¨æ¸ˆã¿ï¼‰

### èªè¨¼ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
- âœ… Google OAuth èªè¨¼
- âœ… ç®¡ç†è€…ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒ­ã‚°ã‚¤ãƒ³
- âœ… ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ï¼ˆCookie-basedï¼‰
- âœ… ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã€å…¥åŠ›æ¤œè¨¼ã€XSSå¯¾ç­–

### ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ»é‹ç”¨
- âœ… Cloudflare Pages æœ¬ç•ªç’°å¢ƒãƒ‡ãƒ—ãƒ­ã‚¤
- âœ… PM2ãƒ—ãƒ­ã‚»ã‚¹ç®¡ç†
- âœ… PWAãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆã€Service Worker
- âœ… åŒ…æ‹¬çš„ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆ17/18 PASS = 94%æˆåŠŸç‡ï¼‰

## ğŸ”§ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
- **ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯**: Hono (Cloudflare Workers)
- **ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°**: Tailwind CSS (CDN)
- **ã‚¢ã‚¤ã‚³ãƒ³**: Font Awesome 6.4.0
- **ãƒ•ã‚©ãƒ³ãƒˆ**: Noto Sans JP
- **ãƒãƒ£ãƒ¼ãƒˆ**: Chart.js v4.x
- **HTTP**: Axios 1.6.0

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
- **ãƒ©ãƒ³ã‚¿ã‚¤ãƒ **: Cloudflare Workers
- **API**: Hono REST API
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: Cloudflare D1 (SQLite)
- **ã‚­ãƒ£ãƒƒã‚·ãƒ¥**: Cloudflare Cache API
- **èªè¨¼**: Google OAuth 2.0 + ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰èªè¨¼

### é–‹ç™ºãƒ„ãƒ¼ãƒ«
- **è¨€èª**: TypeScript 5.0
- **ãƒ“ãƒ«ãƒ‰**: Vite
- **ãƒ‡ãƒ—ãƒ­ã‚¤**: Wrangler CLI
- **ãƒ—ãƒ­ã‚»ã‚¹ç®¡ç†**: PM2 (é–‹ç™ºç’°å¢ƒ)

## ğŸ“¦ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

### å¿…è¦è¦ä»¶
- Node.js 18.x ä»¥ä¸Š
- npm ã¾ãŸã¯ yarn
- Cloudflare ã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆãƒ‡ãƒ—ãƒ­ã‚¤ç”¨ï¼‰

### ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †

1. **ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³**
```bash
git clone https://github.com/koki-187/My-Agent-Analitics-genspark.git
cd My-Agent-Analitics-genspark
```

2. **ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**
```bash
npm install
```

3. **ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šï¼ˆç®¡ç†è€…ã®ã¿ï¼‰**

âš ï¸ **ç®¡ç†è€…å‘ã‘**: APIã‚­ãƒ¼ã¯ç®¡ç†è€…ãŒä¸€æ‹¬è¨­å®šã—ã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯è¨­å®šä¸è¦ã§ã™ã€‚

```bash
# .dev.vars ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆãƒ»ç·¨é›†
# å¿…é ˆ: GOOGLE_CLIENT_ID, GOOGLE_CLIENT_SECRET, REINFOLIB_API_KEY, SESSION_SECRET
# ä»»æ„: OPENAI_API_KEY, ESTAT_API_KEY, ITANDI_API_KEY, REINS_LOGIN_ID, REINS_PASSWORD
```

4. **ãƒ“ãƒ«ãƒ‰**
```bash
npm run build
```

5. **é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•**
```bash
# PM2ã§èµ·å‹•ï¼ˆæ¨å¥¨ï¼‰
pm2 start ecosystem.config.cjs

# ã¾ãŸã¯ç›´æ¥èµ·å‹•
npm run dev:sandbox
```

6. **ãƒ–ãƒ©ã‚¦ã‚¶ã§ç¢ºèª**

http://localhost:3000 ã‚’é–‹ã

## ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤

### Cloudflare Pages ã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤

1. **Cloudflare API ãƒˆãƒ¼ã‚¯ãƒ³ã‚’è¨­å®š**
```bash
# GenSpark ã§ setup_cloudflare_api_key ã‚’å®Ÿè¡Œ
```

2. **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒ“ãƒ«ãƒ‰**
```bash
npm run build
```

3. **Cloudflare Pages ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ**
```bash
npx wrangler pages project create my-agent-analytics \
  --production-branch main
```

4. **ãƒ‡ãƒ—ãƒ­ã‚¤**
```bash
npm run deploy:prod
```

5. **ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®š**
```bash
# å¿…é ˆAPIã‚­ãƒ¼
npx wrangler pages secret put GOOGLE_CLIENT_ID --project-name my-agent-analytics
npx wrangler pages secret put GOOGLE_CLIENT_SECRET --project-name my-agent-analytics
npx wrangler pages secret put REINFOLIB_API_KEY --project-name my-agent-analytics
npx wrangler pages secret put SESSION_SECRET --project-name my-agent-analytics

# ä»»æ„ã®APIã‚­ãƒ¼
npx wrangler pages secret put OPENAI_API_KEY --project-name my-agent-analytics
npx wrangler pages secret put ESTAT_API_KEY --project-name my-agent-analytics
npx wrangler pages secret put ITANDI_API_KEY --project-name my-agent-analytics
npx wrangler pages secret put REINS_LOGIN_ID --project-name my-agent-analytics
npx wrangler pages secret put REINS_PASSWORD --project-name my-agent-analytics
```

## ğŸ“– APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

### ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
```http
GET /api/health
```

### ç‰©ä»¶è²¡å‹™åˆ†æ
```http
POST /api/properties/analyze
Content-Type: application/json

{
  "propertyPrice": 50000000,
  "monthlyRent": 400000,
  "occupancyRate": 95,
  "annualExpenses": 1000000,
  "loanAmount": 40000000,
  "interestRate": 2.5,
  "loanTerm": 30,
  "downPayment": 10000000
}
```

### å¸‚å ´å‹•å‘åˆ†æ
```http
POST /api/market/analyze
Content-Type: application/json

{
  "year": 2024,
  "area": "13",
  "city": "13102"
}
```

### ã‚¤ã‚¿ãƒ³ã‚¸BB è³ƒè²¸ç›¸å ´åˆ†æ
```http
POST /api/itandi/rental-analysis
Content-Type: application/json

{
  "address": "æ±äº¬éƒ½æ¸‹è°·åŒº",
  "radius": 1000
}
```

## ğŸ—‚ï¸ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

```
my-agent-analytics/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.tsx              # ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
â”‚   â”œâ”€â”€ types/                 # TypeScriptå‹å®šç¾©
â”‚   â”œâ”€â”€ lib/                   # ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â”‚   â”œâ”€â”€ calculator.ts      # æŠ•è³‡æŒ‡æ¨™è¨ˆç®—ã‚¨ãƒ³ã‚¸ãƒ³
â”‚   â”‚   â”œâ”€â”€ reinfolib.ts       # ä¸å‹•ç”£æƒ…å ±ãƒ©ã‚¤ãƒ–ãƒ©ãƒªAPI
â”‚   â”‚   â”œâ”€â”€ itandi-client.ts   # ã‚¤ã‚¿ãƒ³ã‚¸BB APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ routes/                # ãƒšãƒ¼ã‚¸ã¨APIãƒ«ãƒ¼ãƒˆ
â”‚   â”‚   â”œâ”€â”€ properties.tsx     # ç‰©ä»¶ç®¡ç†ï¼ˆåç›Šãƒ•ã‚©ãƒ¼ãƒ ã€çµ±åˆãƒ¬ãƒãƒ¼ãƒˆå«ã‚€ï¼‰
â”‚   â”‚   â”œâ”€â”€ itandi.tsx         # ã‚¤ã‚¿ãƒ³ã‚¸BBè³ƒè²¸ç›¸å ´åˆ†æ
â”‚   â”‚   â”œâ”€â”€ api.tsx            # APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ middleware/            # èªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢
â”œâ”€â”€ public/                    # é™çš„ãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â””â”€â”€ static/                # JS/CSS/ã‚¢ã‚¤ã‚³ãƒ³
â”œâ”€â”€ migrations/                # D1ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
â”œâ”€â”€ docs/                      # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”œâ”€â”€ ACTUAL_ISSUES_FOUND.md     # âœ¨ å®Ÿè£…çŠ¶æ³ã®çœŸå®Ÿ
â”œâ”€â”€ HOW_TO_CONTINUE_WORK.md    # âœ¨ ä½œæ¥­å¼•ãç¶™ãã‚¬ã‚¤ãƒ‰
â”œâ”€â”€ comprehensive-test.sh      # åŒ…æ‹¬çš„ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ dist/                      # ãƒ“ãƒ«ãƒ‰å‡ºåŠ›
â”œâ”€â”€ wrangler.jsonc             # Cloudflareè¨­å®š
â”œâ”€â”€ vite.config.ts             # Viteãƒ“ãƒ«ãƒ‰è¨­å®š
â”œâ”€â”€ tsconfig.json              # TypeScriptè¨­å®š
â”œâ”€â”€ ecosystem.config.cjs       # PM2è¨­å®š
â””â”€â”€ package.json
```

## ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

- **API Keyç®¡ç†**: ã™ã¹ã¦ã®APIã‚­ãƒ¼ã¯Cloudflare Secretsã§ç®¡ç†
- **èªè¨¼**: Google OAuth + ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰èªè¨¼
- **HTTPS**: ã™ã¹ã¦ã®é€šä¿¡ã¯HTTPSã§æš—å·åŒ–
- **ãƒ¬ãƒ¼ãƒˆåˆ¶é™**: API (100req/min)ã€AI (20req/min)ã€èªè¨¼ (10req/min)
- **XSSå¯¾ç­–**: ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã®è‡ªå‹•ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—

## ğŸ“Š ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

- âš¡ **APIå¿œç­”æ™‚é–“**: < 100ms (ã‚­ãƒ£ãƒƒã‚·ãƒ¥æœ‰åŠ¹æ™‚ < 50ms)
- ğŸ¯ **åˆå›è¡¨ç¤º**: < 1ç§’
- ğŸ“ˆ **ãƒ†ã‚¹ãƒˆæˆåŠŸç‡**: 94% (17/18 PASS)
- ğŸŒ **ã‚°ãƒ­ãƒ¼ãƒãƒ«CDN**: Cloudflare ã®300+ãƒ‡ãƒ¼ã‚¿ã‚»ãƒ³ã‚¿ãƒ¼
- ğŸ’¾ **ãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚º**: 125KB (gzipåœ§ç¸®å¾Œ)

## ğŸ§ª ãƒ†ã‚¹ãƒˆã¨ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### åŒ…æ‹¬çš„ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
```bash
bash comprehensive-test.sh
```

**ãƒ†ã‚¹ãƒˆçµæœ**: 17/18 PASS (94%æˆåŠŸç‡)
- âœ… ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã€UIç”»é¢ã€é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
- âœ… å®Ÿè£…æ¸ˆã¿æ©Ÿèƒ½ç¢ºèªï¼ˆåç›Šãƒ•ã‚©ãƒ¼ãƒ ã€çµ±åˆãƒ¬ãƒãƒ¼ãƒˆã€ã‚¤ã‚¿ãƒ³ã‚¸BBï¼‰

### ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã«å¤‰æ›´ãŒåæ˜ ã•ã‚Œãªã„
```bash
# ãƒ“ãƒ«ãƒ‰ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢
rm -rf dist .wrangler
npm run build

# PM2ã‚’å®Œå…¨å†èµ·å‹•
pm2 delete all
pm2 start ecosystem.config.cjs

# ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒªãƒ­ãƒ¼ãƒ‰
# Chrome/Edge: Ctrl + Shift + R (Windows) / Cmd + Shift + R (Mac)
```

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼
```bash
# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ãƒªã‚»ãƒƒãƒˆ
npm run db:reset

# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å†å®Ÿè¡Œ
npm run db:migrate:local
```

## ğŸ“š ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

### é‡è¦ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆå¿…èª­ï¼‰
- **[ACTUAL_ISSUES_FOUND.md](./ACTUAL_ISSUES_FOUND.md)** - âœ¨ å®Ÿè£…çŠ¶æ³ã®çœŸå®Ÿï¼ˆæœ€å„ªå…ˆã§ç¢ºèªï¼‰
- **[HOW_TO_CONTINUE_WORK.md](./HOW_TO_CONTINUE_WORK.md)** - âœ¨ ä½œæ¥­å¼•ãç¶™ãã‚¬ã‚¤ãƒ‰

### ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰
- **[QUICK_START.md](./docs/QUICK_START.md)** - 5åˆ†ã§èµ·å‹•ã™ã‚‹æœ€çŸ­æ‰‹é †
- **[STARTUP_GUIDE.md](./docs/STARTUP_GUIDE.md)** - è©³ç´°ãªèµ·å‹•æ‰‹é †æ›¸
- **[USER_MANUAL.md](./docs/USER_MANUAL.md)** - ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒãƒ‹ãƒ¥ã‚¢ãƒ«

### èªè¨¼ãƒ»APIã‚­ãƒ¼è¨­å®š
- **[GOOGLE_OAUTH_SETUP.md](./docs/GOOGLE_OAUTH_SETUP.md)** - Google OAuthè¨­å®šã‚¬ã‚¤ãƒ‰
- **[API_KEY_SETUP_GUIDE.md](./docs/API_KEY_SETUP_GUIDE.md)** - APIã‚­ãƒ¼å–å¾—æ‰‹é †

### ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ
- **[CLOUDFLARE_DEPLOYMENT.md](./docs/CLOUDFLARE_DEPLOYMENT.md)** - Cloudflare Pages ãƒ‡ãƒ—ãƒ­ã‚¤
- **[DATABASE_SETUP_GUIDE.md](./docs/DATABASE_SETUP_GUIDE.md)** - D1ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

## ğŸ”— é–¢é€£ãƒªãƒ³ã‚¯

- [Hono ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://hono.dev/)
- [Cloudflare Workers ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://developers.cloudflare.com/workers/)
- [Cloudflare Pages ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://developers.cloudflare.com/pages/)
- [e-Stat API](https://www.e-stat.go.jp/api/)
- [OpenAI API](https://platform.openai.com/docs/)

## ğŸ¤ ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³

ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’æ­“è¿ã—ã¾ã™ï¼å¤§ããªå¤‰æ›´ã®å ´åˆã¯ã€ã¾ãšissueã‚’é–‹ã„ã¦å¤‰æ›´å†…å®¹ã‚’è­°è«–ã—ã¦ãã ã•ã„ã€‚

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ [MIT ãƒ©ã‚¤ã‚»ãƒ³ã‚¹](LICENSE) ã®ä¸‹ã§å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚

## ğŸ“ ã‚µãƒãƒ¼ãƒˆ

å•é¡ŒãŒè§£æ±ºã—ãªã„å ´åˆã¯ã€[GitHubã®Issue](https://github.com/koki-187/My-Agent-Analitics-genspark/issues)ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

**å¿…è¦æƒ…å ±:**
- ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
- å®Ÿè¡Œã—ãŸã‚³ãƒãƒ³ãƒ‰
- ç’°å¢ƒï¼ˆãƒ­ãƒ¼ã‚«ãƒ«/Sandbox/æœ¬ç•ªï¼‰
- ãƒ–ãƒ©ã‚¦ã‚¶ã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³

---

**é–‹ç™ºãƒãƒ¼ãƒ **: My Agent Team  
**æœ€çµ‚æ›´æ–°**: 2025å¹´1æœˆ5æ—¥ï¼ˆSession 2ï¼‰  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 6.8.0+ (Google Custom Search APIçµ±åˆå®Œäº†)  
**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå®Œæˆåº¦**: 95%æ©Ÿèƒ½å®Ÿè£…å®Œäº† âœ…  
**å®Ÿè£…æ©Ÿèƒ½æ•°**: 15æ©Ÿèƒ½ï¼ˆç¨¼åƒç‡100%ï¼‰  
**ãƒ‡ãƒ—ãƒ­ã‚¤çŠ¶æ…‹**: æœ¬ç•ªç’°å¢ƒç¨¼åƒä¸­ ğŸš€  
**æœ¬ç•ªURLï¼ˆæœ€æ–°ï¼‰**: [https://b69092e6.my-agent-analytics.pages.dev](https://b69092e6.my-agent-analytics.pages.dev)  
**GitHub**: [koki-187/My-Agent-Analitics-genspark](https://github.com/koki-187/My-Agent-Analitics-genspark)  
**æœ€æ–°ã‚³ãƒŸãƒƒãƒˆ**: 4b69b85

## ğŸ¯ Session 2å®Œäº† - Google Custom Search APIçµ±åˆã¨UIæ”¹å–„

### å®Œäº†ã—ãŸä½œæ¥­ï¼ˆ2025å¹´1æœˆ5æ—¥ï¼‰

#### âœ… Google Custom Search APIçµ±åˆ
- **2æ®µéšæ¤œç´¢ãƒ—ãƒ­ã‚»ã‚¹å®Ÿè£…**
  - Step 1: Google Custom Search APIã§å®Ÿéš›ã®ã‚¦ã‚§ãƒ–æ¤œç´¢ï¼ˆå¤§å³¶ã¦ã‚‹ã€ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚µã‚¤ãƒˆç­‰ï¼‰
  - Step 2: OpenAI GPT-4ã§æ¤œç´¢çµæœã‚’åˆ†æãƒ»åˆ¤å®š
- **æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ**: `src/lib/google-search-client.ts` - Googleæ¤œç´¢ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
- **å®Œå…¨æ›¸ãæ›ãˆ**: `src/lib/stigma-checker.ts` - 2æ®µéšæ¤œç´¢ãƒ­ã‚¸ãƒƒã‚¯å®Ÿè£…
- **ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œ**: APIã‚­ãƒ¼æœªè¨­å®šæ™‚ã¯é©åˆ‡ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º

#### âœ… UIæ”¹å–„
- **ç”¨èªè§£èª¬ãƒœã‚¿ãƒ³æ”¹å–„** (`src/routes/properties.tsx`)
  - ãƒœã‚¿ãƒ³ã‚µã‚¤ã‚ºæ‹¡å¤§ï¼ˆ`text-xs` â†’ `text-base`ï¼‰
  - ãƒ›ãƒãƒ¼åŠ¹æœè¿½åŠ ï¼ˆ`hover:scale-110`ï¼‰
  - ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£å‘ä¸Šï¼ˆ`title`å±æ€§ï¼‰
  
- **ã‚³ã‚¹ãƒˆæƒ…å ±è¿½åŠ ** (`src/routes/stigma.tsx`)
  - é‡è¦äº‹é …èª¿æŸ»å ±å‘Šæ›¸ã®è²»ç”¨è¡¨ç¤º
  - 22,000ã€œ55,000å††/æˆ¸ï¼ˆç®¡ç†ä¼šç¤¾ã«ã‚ˆã‚Šç•°ãªã‚‹ï¼‰

#### âœ… ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†
- GitHub ãƒ—ãƒƒã‚·ãƒ¥å®Œäº†: ã‚³ãƒŸãƒƒãƒˆ 4b69b85
- Cloudflare Pages ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†: https://b69092e6.my-agent-analytics.pages.dev
- å¼•ãç¶™ããƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆ: `HANDOFF_2025-01-05_SESSION-2.md`

### âš ï¸ æ¬¡ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§å®Ÿæ–½ã™ã¹ãä½œæ¥­

#### 1. ç’°å¢ƒå¤‰æ•°è¨­å®šï¼ˆå¿…é ˆï¼‰
ä»¥ä¸‹ã®APIã‚­ãƒ¼ã‚’Cloudflare Pagesã®ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã«è¨­å®šã—ã¦ãã ã•ã„ï¼š

```bash
# Google Custom Search APIï¼ˆäº‹æ•…ç‰©ä»¶èª¿æŸ»ç”¨ï¼‰
npx wrangler pages secret put GOOGLE_CUSTOM_SEARCH_API_KEY --project-name my-agent-analytics
npx wrangler pages secret put GOOGLE_CUSTOM_SEARCH_ENGINE_ID --project-name my-agent-analytics

# ã‚¤ã‚¿ãƒ³ã‚¸BBèªè¨¼æƒ…å ±ï¼ˆè³ƒè²¸ç›¸å ´åˆ†æç”¨ï¼‰
npx wrangler pages secret put ITANDI_EMAIL --project-name my-agent-analytics
npx wrangler pages secret put ITANDI_PASSWORD --project-name my-agent-analytics
```

#### 2. å®Ÿåœ°ãƒ†ã‚¹ãƒˆ
- **äº‹æ•…ç‰©ä»¶èª¿æŸ»**: 3ã¤ã®ä½æ‰€ã§ãƒ†ã‚¹ãƒˆ
  - æ±äº¬éƒ½æ¸¯åŒºå…­æœ¬æœ¨7-18-18
  - æ±äº¬éƒ½æ¸‹è°·åŒºé“ç„å‚1-10-7
  - æ±äº¬éƒ½æ¿æ©‹åŒºè“®æ ¹äºŒä¸ç›®17-7
- **ã‚¤ã‚¿ãƒ³ã‚¸BBå•é¡Œèª¿æŸ»**: ãƒ­ã‚´ã‚¨ãƒ©ãƒ¼ã€ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰ãƒãƒŠãƒ¼è¡¨ç¤ºå•é¡Œã®è§£æ±º

è©³ç´°ã¯ `HANDOFF_2025-01-05_SESSION-2.md` ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

---

## ğŸ¯ Phase 2å®Œäº† - ã‚¤ã‚¿ãƒ³ã‚¸BB APIä¿®æ­£ã¨ãƒ†ã‚¹ãƒˆæ¤œè¨¼

### ä¿®æ­£å†…å®¹
- âœ… **ã‚¤ã‚¿ãƒ³ã‚¸BB APIé‡è¤‡å®šç¾©å‰Šé™¤** - `src/routes/api.tsx`ã®81è¡Œå‰Šé™¤
- âœ… **ãƒ“ãƒ«ãƒ‰æˆåŠŸç¢ºèª** - ã‚¨ãƒ©ãƒ¼ã‚¼ãƒ­ã§ãƒ“ãƒ«ãƒ‰å®Œäº†
- âœ… **åŒ…æ‹¬çš„ãƒ†ã‚¹ãƒˆå®Ÿæ–½** - 17/18 PASSï¼ˆ94%æˆåŠŸç‡ï¼‰
- âœ… **GitHub ãƒ—ãƒƒã‚·ãƒ¥** - ã‚³ãƒŸãƒƒãƒˆ: 9757672
- âœ… **Cloudflare Pages ãƒ‡ãƒ—ãƒ­ã‚¤** - URL: 344024d1
- âœ… **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—** - tar.gzå½¢å¼ã§ä¿å­˜å®Œäº†

### Phase 3å®Œäº† - ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™
- âœ… **ACTUAL_ISSUES_FOUND.md** - å®Ÿè£…çŠ¶æ³ã®çœŸå®Ÿã‚’æ–‡æ›¸åŒ–
- âœ… **HOW_TO_CONTINUE_WORK.md** - ä½œæ¥­å¼•ãç¶™ãã‚¬ã‚¤ãƒ‰ä½œæˆ
- âœ… **README.mdæ›´æ–°** - æœ€æ–°ã®å®Ÿè£…çŠ¶æ³ã‚’æ­£ç¢ºã«åæ˜ 

### å®Ÿè£…ç¢ºèªæ¸ˆã¿æ©Ÿèƒ½
1. **ç‰©ä»¶åç›Šãƒ‡ãƒ¼ã‚¿å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ** - `/properties/:id/analyze` âœ…
2. **çµ±åˆåˆ†æãƒ¬ãƒãƒ¼ãƒˆãƒšãƒ¼ã‚¸** - `/properties/:id/comprehensive-report` âœ…
3. **ã‚¤ã‚¿ãƒ³ã‚¸BB è³ƒè²¸ç›¸å ´åˆ†æ** - `/itandi/rental-market` âœ…
4. **åˆ†æå®Ÿè¡Œãƒšãƒ¼ã‚¸** - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è²¡å‹™åˆ†æ âœ…
5. **äº‹æ•…ç‰©ä»¶èª¿æŸ»** - Google Custom Search API + AIåˆ†æ âœ…

**é‡è¦**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå ±å‘Šã—ãŸã€Œæœªå®Ÿè£…ã€ã¨æ€ã‚ã‚Œã¦ã„ãŸæ©Ÿèƒ½ã¯ã€å®Ÿéš›ã«ã¯æ—¢ã«å®Ÿè£…æ¸ˆã¿ã§ã—ãŸã€‚è©³ç´°ã¯ `ACTUAL_ISSUES_FOUND.md` ã¨ `HOW_TO_CONTINUE_WORK.md` ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
